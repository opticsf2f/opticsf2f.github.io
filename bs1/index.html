<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <marimo-mode data-mode='read' hidden></marimo-mode>
    <marimo-version data-version='0.10.19' hidden></marimo-version>
    <marimo-user-config data-config='{"completion": {"activate_on_typing": true, "copilot": false}, "display": {"theme": "light", "code_editor_font_size": 14, "cell_output": "above", "default_width": "medium", "dataframes": "rich"}, "formatting": {"line_length": 79}, "keymap": {"preset": "default", "overrides": {}}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "on_cell_change": "autorun"}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "package_management": {"manager": "pip"}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}}' data-overrides='{}' hidden></marimo-user-config>
    <marimo-app-config data-config='{"width": "medium"}' hidden></marimo-app-config>
    <marimo-server-token data-token='123' hidden></marimo-server-token>
    <title>marimo</title>
    <script type="module" crossorigin src="./assets/index-C_IDebto.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-DfLILvXO.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="" data-show-code="false">import%20marimo%0A%0A__generated_with%20%3D%20%220.10.19%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo%2C%20np)%3A%0A%20%20%20%20Omega%20%3D%20mo.ui.slider(start%3D0%2C%20stop%3D10%2C%20step%3D1%2C%20label%3D%22Omega%22%2C%20value%3D5)%0A%20%20%20%20Delta%20%3D%20mo.ui.slider(start%3D0%2C%20stop%3D10%2C%20step%3D1%2C%20label%3D%22Delta%22%2C%20value%3D10)%0A%20%20%20%20phiL%20%3D%20mo.ui.slider(start%3D0%2C%20stop%3D2*np.pi%2C%20step%3D0.1*np.pi%2C%20label%3D%22phiL%22%2C%20value%3Dnp.pi%2F2)%0A%20%20%20%20t%20%3D%20mo.ui.slider(start%3D0%2C%20stop%3D100%2C%20step%3D1%2C%20label%3D%22time%22%2C%20value%3D10)%0A%20%20%20%20mo.hstack(%5Bmo.vstack(%5BOmega%2CDelta%2CphiL%5D)%2C%20mo.vstack(%5Bt%5D)%5D)%0A%20%20%20%20return%20Delta%2C%20Omega%2C%20phiL%2C%20t%0A%0A%0A%40app.cell%0Adef%20_(BlochSphere%2C%20Delta%2C%20Omega%2C%20phiL%2C%20t)%3A%0A%20%20%20%20BlochSphere(Omega.value%2CDelta.value%2CphiL.value%2Ct.value)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Arrows%2C%20np%2C%20plt%2C%20trajectory)%3A%0A%20%20%20%20def%20BlochSphere(Omega%2CDelta%2CphiL%2Ct)%3A%0A%20%20%20%20%20%20%20%20Omeff%20%3D%20np.sqrt(Omega**2%2BDelta**2)%20%20%20%20%0A%20%20%20%20%20%20%20%20dynamics%2C%20rho%20%3D%20trajectory(Omega%2CDelta%2CphiL)%0A%20%20%20%20%20%20%20%20t_pts%2C%20dim%20%3D%20np.shape(dynamics)%0A%0A%20%20%20%20%20%20%20%20R%2C%20G%2C%20B%20%3D%200.8%20*%20np.ones((400%2C%20400))%2C%201.0%20*%20np.ones((400%2C%20400))%2C%201.0%20*%20np.ones((400%2C%20400))%0A%20%20%20%20%20%20%20%20img_lens%20%3D%20np.dstack(%5BR%2C%20G%2C%20B%5D)%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20plt.figure(figsize%20%3D%20(8%2C8)%2C%20dpi%20%3D%20300)%0A%20%20%20%20%20%20%20%20ax%20%3D%20fig.add_subplot(1%2C1%2C1%2C%20projection%20%3D%20'3d')%0A%0A%20%20%20%20%20%20%20%20time_point%20%3D%20int(t)%0A%20%20%20%20%20%20%20%20u%2C%20v%20%3D%20np.mgrid%5B0%3A2*np.pi%3A145j%2C%200%3Anp.pi%3A73j%5D%0A%20%20%20%20%20%20%20%20x%20%3D%20np.cos(u)*np.sin(v)%0A%20%20%20%20%20%20%20%20y%20%3D%20np.sin(u)*np.sin(v)%0A%20%20%20%20%20%20%20%20z%20%3D%20np.cos(v)%0A%0A%20%20%20%20%20%20%20%20ax.plot_surface(x%2Cy%2Cz%2Crstride%3D2%2Ccstride%3D2%2Cshade%3DTrue%2C%20alpha%20%3D%200.25%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20facecolors%20%3D%20img_lens%2Clinewidth%3D0.1%2Czorder%20%3D%201)%0A%0A%20%20%20%20%20%20%20%20arrows%20%3D%20Arrows(Omega%2CDelta%2CphiL%2Cdynamics%2Ctime_point)%0A%20%20%20%20%20%20%20%20for%20arrow%20in%20arrows%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20ax.add_artist(arrow)%0A%20%20%20%20%20%20%20%20%5Bax.scatter(*coords%2C%20color%3D'black')%20for%20coords%20in%20%5B(0%2C%201%2C%200)%2C%20(1%2C%200%2C%200)%2C%20(0%2C%200%2C%201)%5D%5D%0A%0A%20%20%20%20%20%20%20%20for%20ii%20in%20range(0%2Ct_pts)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20ax.scatter(dynamics%5Bii%2C0%5D%2Cdynamics%5Bii%2C1%5D%2Cdynamics%5Bii%2C2%5D%2Ccolor%3D'red'%2Cs%3D2)%0A%0A%20%20%20%20%20%20%20%20ax.view_init(20%2C40)%0A%20%20%20%20%20%20%20%20ax.set_box_aspect((40%2C%2040%2C%2040))%20%20%23%20aspect%20ratio%20is%201%3A1%3A1%20in%20data%20space%0A%20%20%20%20%20%20%20%20ax.set_xlim(-1.1%2C1.1)%0A%20%20%20%20%20%20%20%20ax.set_zlim(-1.1%2C1.1)%0A%20%20%20%20%20%20%20%20ax.set_ylim(-1.1%2C1.1)%0A%20%20%20%20%20%20%20%20ax._axis3don%20%3D%20False%0A%20%20%20%20%20%20%20%20return%20fig%2C%0A%20%20%20%20return%20(BlochSphere%2C)%0A%0A%0A%40app.cell%0Adef%20_(Arrow3D%2C%20np)%3A%0A%20%20%20%20def%20Arrows(Omega%2CDelta%2CphiL%2Cdynamics%2Ctime_point)%3A%0A%20%20%20%20%20%20%20%20Omeff%20%3D%20np.sqrt(Omega**2%2BDelta**2)%20%20%20%20%0A%20%20%20%20%20%20%20%20arrow_prop_dict%20%3D%20dict(mutation_scale%3D5%2C%20arrowstyle%3D'-%7C%3E'%2C%20color%3D'black'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20linewidth%3D2%2C%20alpha%3D0.5%2C%20shrinkA%3D0%2C%20shrinkB%3D0)%0A%0A%20%20%20%20%20%20%20%20coords%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20(np.array(%5B0%2C%200%5D)%2C%20np.array(%5B0%2C%201.2%5D)%2C%20np.array(%5B0%2C%200%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(np.array(%5B0%2C%201.2%5D)%2C%20np.array(%5B0%2C%200%5D)%2C%20np.array(%5B0%2C%200%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(np.array(%5B0%2C%200%5D)%2C%20np.array(%5B0%2C%200%5D)%2C%20np.array(%5B0%2C%201.2%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(np.array(%5B0%2C%201%2FOmeff*(Omega*np.cos(phiL))%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20np.array(%5B0%2C%201%2FOmeff*(Omega*np.sin(phiL))%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20np.array(%5B0%2C%201%2FOmeff*Delta%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20(np.array(%5B0%2C%20dynamics%5Btime_point%2C0%5D%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20np.array(%5B0%2C%20dynamics%5Btime_point%2C1%5D%5D)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20np.array(%5B0%2C%20dynamics%5Btime_point%2C2%5D%5D))%0A%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20arrows%20%3D%20%5BArrow3D(x%5B-2%3A%5D%2C%20y%5B-2%3A%5D%2C%20z%5B-2%3A%5D%2C%20**arrow_prop_dict)%20for%20x%2C%20y%2C%20z%20in%20coords%5D%0A%0A%20%20%20%20%20%20%20%20arrows%5B3%5D.set_color('orange')%0A%20%20%20%20%20%20%20%20arrows%5B3%5D.set_alpha(1.0)%20%20%23%20Reset%20transparency%0A%20%20%20%20%20%20%20%20arrows%5B3%5D.set_linewidth(2)%20%20%23%20Reset%20line%20width%0A%20%20%20%20%20%20%20%20arrows%5B4%5D.set_color('blue')%0A%20%20%20%20%20%20%20%20arrows%5B4%5D.set_alpha(1.0)%20%20%23%20Reset%20transparency%0A%20%20%20%20%20%20%20%20arrows%5B4%5D.set_linewidth(4)%20%20%23%20Reset%20line%20width%0A%20%20%20%20%20%20%20%20return%20arrows%0A%20%20%20%20return%20(Arrows%2C)%0A%0A%0A%40app.cell%0Adef%20_(eig%2C%20kron%2C%20np)%3A%0A%20%20%20%20def%20trajectory(Omega%2CDelta%2CphiL)%3A%0A%20%20%20%20%20%20%20%20G%20%3D%200.0%0A%20%20%20%20%20%20%20%20H%3Dnp.array(%5B%5BDelta%2F2%2C%20(Omega%2F2)*np.exp(-1.j*phiL)%5D%2C%5B(Omega%2F2)*np.exp(1.j*phiL)%2C%20-Delta%2F2%5D%20%5D)%0A%20%20%20%20%20%20%20%20I2%3Dnp.eye(2%2C2)%0A%20%20%20%20%20%20%20%20Hrho%3Dkron(H%2CI2)%0A%20%20%20%20%20%20%20%20rhoH%3Dkron(I2%2Cnp.conj(H))%0A%20%20%20%20%20%20%20%20L%3Dnp.array(%5B%5B0%2C0%2C0%2CG%5D%2C%5B0%2C-G%2F2%2C0%2C0%5D%2C%5B0%2C0%2C-G%2F2%2C0%5D%2C%5B0%2C0%2C0%2C-G%5D%20%5D)%0A%20%20%20%20%20%20%20%20evals%2C%20evecs%20%3D%20eig(-1.j*(Hrho-rhoH)%2BL)%0A%20%20%20%20%20%20%20%20evecs%3Dnp.asmatrix(evecs)%0A%20%20%20%20%20%20%20%20rho0%3D0.0*np.ones((4%2C1))%0A%20%20%20%20%20%20%20%20rho0%5B0%5D%20%3D%201.0%0A%20%20%20%20%20%20%20%20npts%3D100%0A%20%20%20%20%20%20%20%20tmax%3D2*np.pi%2Fnp.sqrt(Omega**2%2BDelta**2)%0A%20%20%20%20%20%20%20%20t%3Dnp.linspace(0%2Ctmax%2Cnpts)%0A%20%20%20%20%20%20%20%20u%3Dnp.zeros(npts)%0A%20%20%20%20%20%20%20%20v%3Dnp.zeros(npts)%0A%20%20%20%20%20%20%20%20w%3Dnp.zeros(npts)%0A%20%20%20%20%20%20%20%20rho%20%3D%20(1.0%20%2B%201.j)*np.zeros((4%2Cnpts))%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(0%2Cnpts)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20rho_vec%3Devecs*np.asmatrix(np.diag(np.exp(evals*t%5Bi%5D)))*np.linalg.inv(evecs)*rho0%0A%20%20%20%20%20%20%20%20%20%20%20%20rho%5B%3A%2Ci%5D%20%3D%20np.squeeze(np.asarray(rho_vec))%0A%20%20%20%20%20%20%20%20%20%20%20%20u%5Bi%5D%3D(rho%5B1%2Ci%5D%2Brho%5B2%2Ci%5D).real%0A%20%20%20%20%20%20%20%20%20%20%20%20v%5Bi%5D%3D(1.j*(rho%5B1%2Ci%5D-rho%5B2%2Ci%5D)).real%0A%20%20%20%20%20%20%20%20%20%20%20%20w%5Bi%5D%3D(rho%5B0%2Ci%5D-rho%5B3%2Ci%5D).real%0A%20%20%20%20%20%20%20%20return%20np.column_stack((u%2C%20v%2C%20w))%2C%20rho%0A%20%20%20%20return%20(trajectory%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20time%0A%20%20%20%20import%20matplotlib%20as%20mpl%0A%20%20%20%20from%20scipy.linalg%20import%20kron%2C%20eig%0A%20%20%20%20from%20matplotlib.patches%20import%20FancyArrowPatch%0A%20%20%20%20from%20mpl_toolkits.mplot3d%20import%20proj3d%0A%0A%20%20%20%20class%20Arrow3D(FancyArrowPatch)%3A%0A%20%20%20%20%20%20%20%20def%20__init__(self%2C%20xs%2C%20ys%2C%20zs%2C%20*args%2C%20**kwargs)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20super().__init__((0%2C%200)%2C%20(0%2C%200)%2C%20*args%2C%20**kwargs)%0A%20%20%20%20%20%20%20%20%20%20%20%20self._verts3d%20%3D%20xs%2C%20ys%2C%20zs%0A%0A%20%20%20%20%20%20%20%20def%20do_3d_projection(self%2C%20renderer%3DNone)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20xs3d%2C%20ys3d%2C%20zs3d%20%3D%20self._verts3d%0A%20%20%20%20%20%20%20%20%20%20%20%20xs%2C%20ys%2C%20zs%20%3D%20proj3d.proj_transform(xs3d%2C%20ys3d%2C%20zs3d%2C%20self.axes.M)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.set_positions((xs%5B0%5D%2C%20ys%5B0%5D)%2C%20(xs%5B1%5D%2C%20ys%5B1%5D))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20np.min(zs)%0A%20%20%20%20return%20Arrow3D%2C%20FancyArrowPatch%2C%20eig%2C%20kron%2C%20mpl%2C%20np%2C%20plt%2C%20proj3d%2C%20time%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
  </body>
</html>
